# 压缩包自动处理工具

一个具有图形化界面的压缩包自动检测、修正和解压工具。

## 功能特性

### 🔧 智能压缩包处理
- **格式检测**：自动检测格式异常的压缩包（如".7z删"、".zip备份"等）
- **格式修正**：将异常格式自动修正为标准压缩包格式
- **支持格式**：.7z、.zip、.rar、.tar、.gz、.bz2、.xz

### 🔓 智能解压功能
- **Bandizip集成**：调用Bandizip进行解压操作
- **密码管理**：图形界面管理常用解压密码
- **自动填充**：自动尝试保存的密码进行解压

### 🔄 递归处理
- **深度扫描**：解压完成后自动扫描子文件夹
- **智能终止**：当文件夹中文件数量>2时自动停止处理
- **批量处理**：一次性处理整个目录树

## 安装要求

### 系统要求
- Windows 操作系统
- Python 3.7+（仅源码运行需要）
- Bandizip（用于解压操作）

### Python依赖
```bash
pip install -r requirements.txt
```

### Bandizip安装
1. 下载并安装 [Bandizip](https://www.bandisoft.com/bandizip/)
2. 程序会自动检测常见安装路径
3. 如未找到，程序会提示手动选择Bandizip.exe

## 使用方法

### 快速开始（推荐）
直接运行打包好的可执行文件：
```
Butter unpacker.exe
```

### 源码运行
```bash
python archive_processor.py
```

### 2. 选择文件夹
- **方法一**：直接将文件夹拖放到程序界面的拖放区域
- **方法二**：点击拖放区域的图标或文字快速选择文件夹
- **方法三**：点击"选择文件夹"按钮，通过对话框选择

### 3. 密码管理（可选）
- 点击"密码管理"按钮
- 添加常用的解压密码
- 程序会自动尝试这些密码进行解压

### 4. 开始处理
- 点击"开始处理"按钮
- 程序会自动：
  - 扫描文件夹中的异常压缩包
  - 修正文件名格式
  - 尝试解压文件
  - 递归处理子文件夹

### 5. 查看日志
- 处理过程中的所有操作都会在日志区域显示
- 包括文件发现、格式修正、解压结果等信息

## 配置文件

程序会在同目录下创建`config.json`文件，用于保存：
- 常用解压密码列表
- 其他用户设置

## 注意事项

1. **备份重要数据**：处理前请备份重要文件
2. **Bandizip路径**：确保Bandizip已正确安装
3. **文件权限**：确保程序有读写目标文件夹的权限
4. **处理时间**：大文件解压可能需要较长时间

## 故障排除

### 常见问题

**Q: 程序提示找不到Bandizip**
A: 请手动下载安装Bandizip，或在程序提示时手动选择Bandizip.exe路径

**Q: 解压失败**
A: 检查密码是否正确，或者压缩包是否损坏

**Q: 拖放功能不工作**
A: 确保以管理员权限运行程序，或重新安装tkinterdnd2依赖

**Q: 程序界面卡死**
A: 处理大文件时属于正常现象，请查看日志区域了解进度

## 发布版本

### 可执行文件版本
- **文件名**：Butter unpacker.exe
- **大小**：约25MB
- **特点**：
  - 无需安装Python环境
  - 包含所有必要依赖
  - 双击即可运行
  - 支持所有原有功能

### 打包信息
- **打包工具**：PyInstaller 6.3.0
- **打包参数**：--onefile --windowed
- **兼容性**：Windows 7/8/10/11

## 技术实现

- **GUI框架**：tkinter + tkinterdnd2
- **文件处理**：Python标准库
- **解压工具**：Bandizip命令行接口
- **配置管理**：JSON格式
- **多线程**：避免界面卡死
- **系统集成**：win32api（Windows系统弹窗）
- **打包工具**：PyInstaller（生成独立exe文件）

## 许可证

本项目仅供学习和个人使用。